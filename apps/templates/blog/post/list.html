{% extends "base.html" %}
{% load blog_tags %}

{% block title %}Blog{% endblock title %}

{% block content %}

<div class="container-fluid vh-100">
    <div class="row vh-100 p-0 justify-content-center">

        <div id="Main" class="col-8 p-5 border-end border-dark">

            <!-- <div class="row">
                <div class="col">
                    <div class="row">
                        <div id="SearchBar" class="p-0 m-0">
                            <form class="container px-1 m-2">
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fa-solid fa-magnifying-glass fa-shake"></i></span>
                                    <input type="search" class="form-control" placeholder="Search" aria-label="Search">
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col ">
                    <div class="row p-0 m-0">
                        <div class="row px-1 m-2 align-items-center justify-content-end">
                            <div class="col-3 p-0"><span class="fs-6 badge bg-secondary">Tag 1</span></div>
                            <div class="col-3 p-0"><span class="fs-6 badge bg-secondary">Tag 1</span></div>
                            <div class="col-3 p-0"><span class="fs-6 badge bg-secondary">Tag 1</span></div>
                        </div>
                    </div>
                </div>
            </div> -->

            <div class="container-fluid p-0 mt-2" style="font-family: 'Raleway', sans-serif;">
                {% if tag %}
                    <h2 class="m-0 p-0">Posts tagged with <p class="badge rounded-pill bg-light text-muted m-0">{{ tag.name }}</p></h2>
                {% endif %}
            </div>

            <div class="row">
                <div class="col">

                    {% for post in posts %}

                    <div id="Post" class="row border border-dark my-3 m-1 p-3">
                        <div class="col">
                            <div id="Post Title" class="row">
                                <div class="col"><a href="{{ post.get_absolute_url }}"><h2 style="font-family: 'Roboto Serif', serif; color: black;">{{ post.title }}</h2></a></div>
                            </div>
                            <div id="Post Header" class="row">
                                <div class="col mb-2 card-subtitle text-muted" style="font-family: 'Raleway', sans-serif; color: black; font-size: 12px;">
                                    <span class="m-1"><i class="fa-regular fa-circle-user"></i> {{ post.author }}</span>
                                    <span class="m-1"><i class="fa-regular fa-calendar"></i> {{ post.published_at }}</span>
                                </div>
                            </div>
                            <div id="Post Tags" class="row">
                                <div class="col">
                                    <div class="text-muted" style="font-family: 'Raleway', sans-serif; color: black; font-size: 14px;">
                                        Tags:
                                        {% for tag in post.tags.all %}
                                            <a href="{% url 'blog:post_list_by_tag' tag.slug %}">
                                                <span class="badge rounded-pill bg-light text-muted">{{ tag.name }}</span>
                                            </a>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div id="Post Body" class="row" style="font-family: 'Lato', sans-serif; color: black;">
                                <div class="col">
                                    <p>{{ post.body|markdown|truncatewords_html:40 }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    {% endfor %}

                </div>
            </div>

            {% include "pagination.html" with page=posts %}

        </div>

        <div id="Sidebar" class="col-4 p-3">

            <div class="row">
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <div id="RSS Subscription" class="row border border-dark my-3 m-1 p-3">
                                <div class="col text-center lh-1" style="font-family: 'Raleway', sans-serif; color: black; font-weight: 600;">
                                    <p>Get'em while they're hot. üçû üî•</p>
                                    <a href="{% url 'blog:post_feed' %}">Subscribe to my RSS feed.</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div id="Latest Posts" class="row border border-dark my-3 m-1 p-3">
                                <h3 style="font-family: 'Raleway', sans-serif;">Latest Posts</h3>
                                {% show_latest_posts %}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div id="PopularPosts" class="row border border-dark my-3 m-1 p-3">
                                <h3 style="font-family: 'Raleway', sans-serif;">Popular Posts</h3>
                                {% get_most_commented_posts as popular_posts %}
                                <ul>
                                    {% for post in popular_posts %}
                                        <li style="font-family: 'Lato', sans-serif; list-style:none;"><a href="{{ post.get_absolute_url }}"><p  style=" color: black;">{{ post.title }}</p></a></li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        
    </div>
</div>

{% endblock content %}